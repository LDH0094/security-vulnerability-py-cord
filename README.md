### CVE-2022-36024
### The following project aims to monitor one of the major vulnerabilities of Discord API wrapper, py-cord.

###### Note: Do not build your bot with this specific version of py-cord, as doing so would make your bot vulnerable to a remote shutdown by any user.

v.2.0.0 thus, is highly vulnerable for bots added to any server with the `applications.commands` scope without the `bot` scope.

Bot added with `applications.commands` scope without the `bot` scope

### Bot added with application.commands Scope
![vulnerable](screenshots/Vulnerability-add.png)

By adding this simple Bot (created with py-cord v.2.0.0) with the `applications.commands` scope (that allows embedded Discord "/" commands) and omitting the `bot` scope, any registered "/" command (such as `/hello` and `/ping`) executed on the server will shutdown the entire bot remotely, affecting all servers the bot is in.

### High Vulnerabilty of CVE-2022-36024
High Vulnerabilty of CVE-2022-36024
When adding a bot, usually it comes with a url that is generated by Discord that includes the scope need by the Discord server. https://discord.com/oauth2/authorize?client_id={client_id}&permissions=0&scope=applications.commands+bot

The url parameters can be easily manipulated and malicious actors can remove the `+bot` in the url,

> https://discord.com/oauth2/authorize?client_id={client_id}&permissions=0&scope=applications.commands+bot
>
> <img src="screenshots/+bot.png" alt="with_bot_scope"  height="500">


to

> https://discord.com/oauth2/authorize?client_id={client_id}&permissions=0&scope=applications.commands
>
> <img src="screenshots/without_+bot.png" alt="without_bot_scope"  height="500">

> *Note how the `Add a bot to a server` portion is now gone*

This leads to the bot being added without the `bot` scope. These actors can then remotely shutdown the bot by using any of the availble slash commands of the bot.

### Solution to CVE-2022-36024
To avoid this critical security vulnerability an upgrade is "required" 
```sh
$ pip install py-cord
```